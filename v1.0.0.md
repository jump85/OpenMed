## CONFIGURAZIONE AMBIENTE DI SVILUPPO E COMANDI UTILI

### IBMCLOUD

#### Configurazione

* Creare un account personale su IBMCloud: https://cloud.ibm.com/registration
* Scaricare la CLI: 

  ```
  curl -sL https://ibm.biz/idt-installer | bash # Installa la CLI
  ibmcloud dev help # Verifica che l'installazione sia andata a buon fine
  ```

* Configurare l'ambiente IBMCloud
  * Effettua il login al proprio account: 

    ```
    ibmcloud login 
    ```

  * Configurare il puntamento al namespace principale (es: organization = <your_email>, space = dev):
  
    ```
    ibmcloud target -o <organization> -s <space> 
    ```

#### Comandi

* Elenco delle action disponibili

  ```
  ibmcloud ibmcloud fn action list
  ```

* Creazione o aggiornamento di una action

  ```
  ibmcloud ibmcloud fn action [create | update] <package_name>/<action_name> <action_file>
  ```

* Cancellazione di una action

  ```
  ibmcloud ibmcloud fn action delete <package_name>/<action_name>
  ```

* Mostra i dettagli di una action

  ```
  ibmcloud ibmcloud fn action get <package_name>/<action_name>
  ```

* Invocazione di una action

  ```
  ibmcloud fn action invoke -r <package_name>/<action_name> -param <param_1_name> <param_1_value> -param <param_2_name> <param_2_value>
  ```

### CLOUDANT

#### Configurazione

* Link con documentazione completa:
  * https://cloud.ibm.com/docs/openwhisk?topic=openwhisk-pkg_cloudant
  * https://cloud.ibm.com/docs/Cloudant?topic=Cloudant-creating-an-ibm-cloudant-instance-on-ibm-cloud-by-using-the-ibm-cloud-cli

* Creare un account personale Cloudant: https://www.ibm.com/it-it/cloud/cloudant

* Creare un package di servizio Cloudant

  ```
  ibmcloud fn package bind /whisk.system/cloudant <cloudant_package_name>
  ```

* Elencare le risorse attive (tra cui il package appena creato) 

  ```
  ibmcloud resource service-instances
  ```

* Creare le credenziali per il package Cloudant

  ```
  ibmcloud resource service-key-create <credentials_name> Manager --instance-name <cloudant_instance_name>
  ```

* Elencare le credenziali per il package Cloudant

  ```
  ibmcloud resource service-keys --instance-name <cloudant_instance_name>
  ```

* Creare un bind tra il package Cloudant e le Functions, usando le credenziali definite prima

  ```
  ibmcloud fn service bind cloudantnosqldb <cloudant_bind_name> --instance <cloudant_instance_name> --keyname '<credentials_name>'
  ```

* Verificare che il bind sia avvenuto con successo

  ```
  ibmcloud fn package get <cloudant_package_name> parameters
  ```

### Action JavaScript

* Uso dei file .env per le variabili d'ambiente

  ```
  # posizionarsi a livello del package.json
  npm install dotenv
  touch .env
  echo "<env_variable_name>=<env_variable_value>" >> .env
  ```

* Creazione del file da caricare come action

  ```
  # posizionarsi a livello del package.json
  zip -r <js_action_name.zip> .
  ```

* Creazione di una action

  ```
  ibmcloud fn action create <package_name>/<action_name> --kind nodejs:10 <js_action_name.zip>
  ```

### Info utili

* Se si sviluppa con Visual Studio Code Ã¨ consibile installare il plugin 'ESLint' di Dirk Baeumer, in modo da usare regole di linting del codice condivise